<ActorFrame><children>
<ActorFrame OnCommand="x,-320;y,-240"><children>
<ActorFrame OnCommand="" ><children>


<CODE
Type="Quad"
OnCommand="hidden,1"
InitCommand="%function(self)
	--loot_jb_speedmod = 1.33;
	loot_jb_speedmod = 2;
	loot_curnote_jb = 1;
	
	loot_jb_npos = {{168-83,168,168,168+83},{324,324+83,324-83,324}}
	
	loot_jb_ptr = {1,1};
	loot_jb_notes = {{},{}};
	function loot_jb_spawn_note(beat,col,speedmod,pn)
		
		local a = loot_jb_notes[pn][ loot_jb_ptr[pn] ]
		
		a:hidden(0);
		a:diffusealpha(1);
		a:x(loot_jb_npos[1][col+1]+((pn-1)*300));
		a:y(loot_jb_npos[2][col+1]);
		
		--Trace('JB p'..pn..' x: '..a:GetX());
		
		a:animate(1);
		a:setstate(0);
		
		a:sleep((180/loot_bpm)/loot_jb_speedmod);
		a:queuecommand('Hide');
		
		loot_jb_ptr[pn] = loot_jb_ptr[pn]+1;
		if loot_jb_ptr[pn] > table.getn(loot_jb_notes[pn]) then
			loot_jb_ptr[pn] = 1;
		end
		
	end
	
end"
/>

<CODE
Type="Quad"
OnCommand="hidden,1"
InitCommand="%function(self)
	loot_jb_on = {false,false};
	loot_jb_bonus = {0,0};
end"
UpdateScoreMessageCommand="%function(self)
	
	for pn=1,2 do
		if loot_jb_bonus[pn] < 0 then
			loot_jb_bonus[pn] = 0;
		end
		if loot_jb_bonus[pn] > 50 then
			loot_jb_bonus[pn] = 50;
		end

	  if not loot_jb_on[pn] then
		if loot_jb_bonus[pn] == 50 then
		  loot_jb_on[pn] = true;
		  MESSAGEMAN:Broadcast('P'..pn..'TurnOnJ');
		end
	  end

	  if loot_jb_on[pn] then
		if loot_jb_bonus[pn] < 50 then
		  loot_jb_on[pn] = false;
		  MESSAGEMAN:Broadcast('P'..pn..'TurnOffJ');
		end
	  end
	  
	  _G['loot_jb_gtp'..pn]:y(337-(loot_jb_bonus[pn]*(144/50)))
	  _G['loot_jb_gbp'..pn]:y(337+(loot_jb_bonus[pn]*(144/50)))
	  
	  _G['loot_jb_ttp'..pn]:y(337-math.max((loot_jb_bonus[pn]-5)*(144/50),0))
	  _G['loot_jb_tbp'..pn]:y(337+math.max((loot_jb_bonus[pn]-5)*(144/50),0))
	  
	  _G['loot_jb_gtp'..pn]:croptop(loot_jb_bonus[pn]/100)
	  _G['loot_jb_gbp'..pn]:cropbottom(loot_jb_bonus[pn]/100)
	   
	end
  
end"
/>
	
	<0LAER Type="Quad" OnCommand="zoomto,640,480;x,320;y,240;" />
	<Layer Type="ActorFrame" InitCommand="" ><children>
		<Layer File="p1off"	OnCommand="x,320;y,240;horizalign,right;pulse;effectclock,bgm;effectmagnitude,1.02,1,0;effectperiod,2;zoomy,1;" />
		<Layer File="p1on"	OnCommand="x,320;y,240;horizalign,right;zoomy,0;pulse;effectclock,bgm;effectmagnitude,1.05,1,0;effectperiod,2;zoomy,0;"
		P1TurnOnJMessageCommand="zoomy,1;" P1TurnOffJMessageCommand="zoomy,0;" />
		<Layer File="p2off"	OnCommand="x,320;y,240;horizalign,left;pulse;effectclock,bgm;effectmagnitude,1.02,1,0;effectperiod,2;zoomy,1;" />
		<Layer File="p2on"	OnCommand="x,320;y,240;horizalign,left;zoomy,0;pulse;effectclock,bgm;effectmagnitude,1.05,1,0;effectperiod,2;zoomy,0;"
		P2TurnOnJMessageCommand="zoomy,1;" P2TurnOffJMessageCommand="zoomy,0;" />
	</children></Layer>
	
	<Layer File="teethtop" OnCommand="x,320;y,333;horizalign,right;" InitCommand="%function(self) loot_jb_ttp1 = self end"/>
	<Layer File="teethbot" OnCommand="x,320;y,333;horizalign,right;" InitCommand="%function(self) loot_jb_tbp1 = self end"/>
	<Layer File="gatetop" OnCommand="x,320;y,333;horizalign,right;" InitCommand="%function(self) loot_jb_gtp1 = self end"/>
	<Layer File="gatebot" OnCommand="x,320;y,333;horizalign,right;" InitCommand="%function(self) loot_jb_gbp1 = self end"/>
	<Layer File="teethtop" OnCommand="x,320;y,333;horizalign,left;" InitCommand="%function(self) loot_jb_ttp2 = self end"/>
	<Layer File="teethbot" OnCommand="x,320;y,333;horizalign,left;" InitCommand="%function(self) loot_jb_tbp2 = self end"/>
	<Layer File="gatetop" OnCommand="x,320;y,333;horizalign,left;" InitCommand="%function(self) loot_jb_gtp2 = self end"/>
	<Layer File="gatebot" OnCommand="x,320;y,333;horizalign,left;" InitCommand="%function(self) loot_jb_gbp2 = self end"/>
	
	<Layer
	File="header.png"
	OnCommand="x,320;y,240;"
	/>
	
<!-- Score Display -->
<Layer File="score.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoomx,1.2; zoomy,1; x,537+(31*-2); y,147"
UpdateScoreMessageCommand="%function(self) local ass = loot_scoreDisplay if ass >= 10000 then local str = string.format('%05d', ass);
local digit = string.sub(str, 1, 1); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="score.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoomx,1.2; zoomy,1; x,537+(31*-1); y,147"
UpdateScoreMessageCommand="%function(self) local ass = loot_scoreDisplay if ass >= 1000 then local str = string.format('%05d', ass);
local digit = string.sub(str, 2, 2); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="score.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoomx,1.2; zoomy,1; x,537+(31*0); y,147"
UpdateScoreMessageCommand="%function(self) local ass = loot_scoreDisplay if ass >= 100 then local str = string.format('%05d', ass);
local digit = string.sub(str, 3, 3); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="score.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoomx,1.2; zoomy,1; x,537+(31*1); y,147"
UpdateScoreMessageCommand="%function(self) local ass = loot_scoreDisplay if ass >= 10 then local str = string.format('%05d', ass);
local digit = string.sub(str, 4, 4); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="score.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoomx,1.2; zoomy,1; x,537+(31*2); y,147"
UpdateScoreMessageCommand="%function(self) local ass = loot_scoreDisplay local str = string.format('%05d', ass);
local digit = string.sub(str, 5, 5); self:setstate(tonumber(digit)); end" />
	
	<Layer Type="ActorFrame" InitCommand="%function(self) loot_jb_p1 = self end"><children>
	
	<!--combo-->
<Layer File="combo.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoom,0.8; x,168+(36*-1); y,324"
P1UpdateCurComboMessageCommand="%function(self) local ass = loot_comboP1 if ass >= 100 then local str = string.format('%05d', ass);
local digit = string.sub(str, 3, 3); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="combo.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoom,0.8; x,168+(36*0); y,324"
P1UpdateCurComboMessageCommand="%function(self) local ass = loot_comboP1 if ass >= 10 then local str = string.format('%05d', ass);
local digit = string.sub(str, 4, 4); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="combo.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoom,0.8; x,168+(36*1); y,324"
P1UpdateCurComboMessageCommand="%function(self) local ass = loot_comboP1 local str = string.format('%05d', ass);
local digit = string.sub(str, 5, 5); self:setstate(tonumber(digit)); end" />
	
	<Layer
	File="PlayerP1.png"
	OnCommand="x,320;y,240;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addx,-83;rotationz,90;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addx,83;rotationz,-90;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addy,83;rotationz,0;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addy,-83;rotationz,180;"
	/>
	
	</children></Layer>
	
	<Layer Type="ActorFrame" InitCommand="%function(self) loot_jb_p2 = self end"><children>
	
	<!--combo-->
	<Layer File="combo.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoom,0.8; x,468+(36*-1); y,324"
P2UpdateCurComboMessageCommand="%function(self) local ass = loot_comboP2 if ass >= 100 then local str = string.format('%05d', ass);
local digit = string.sub(str, 3, 3); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="combo.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoom,0.8; x,468+(36*0); y,324"
P2UpdateCurComboMessageCommand="%function(self) local ass = loot_comboP2 if ass >= 10 then local str = string.format('%05d', ass);
local digit = string.sub(str, 4, 4); self:setstate(tonumber(digit)); else self:setstate(10) end end" />
<Layer File="combo.sprite"
InitCommand="animate,0; setstate,10; croptop,0.015; cropright,0.015; zoom,0.8; x,468+(36*1); y,324"
P2UpdateCurComboMessageCommand="%function(self) local ass = loot_comboP2 local str = string.format('%05d', ass);
local digit = string.sub(str, 5, 5); self:setstate(tonumber(digit)); end" />
	
	<Layer
	File="PlayerP2.png"
	OnCommand="x,320;y,240;"
	/>
	
	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addx,300;addx,-83;rotationz,90;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addx,300;addx,83;rotationz,-90;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addx,300;addy,83;rotationz,0;"
	/>

	<Layer
	File="Receptor.sprite"
	OnCommand="x,168;y,324;addx,300;addy,-83;rotationz,180;"
	/>
	
	</children></Layer>
	

<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[1],self) end" HideCommand="hidden,1;"/>

<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>
<Layer File="note.sprite" OnCommand="hidden,1;animate,0;sleep,0.015;queuecommand,SetMe"
SetMeCommand="%function(self) table.insert(loot_jb_notes[2],self) end" HideCommand="hidden,1;"/>

</children></ActorFrame>
</children></ActorFrame>
</children></ActorFrame>