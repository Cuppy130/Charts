<ActorFrame> <children>

	<ActorFrame OnCommand="%function(self) gorge_bg2 = self; self:hidden(1) self:fov(60) end"> <children>
	<Layer
		File="skybg" NameCommand="%function(self) gorge_sky1 = self end"
		OnCommand="hidden,0;playcommand,Name;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;ZoomToWidth,SCREEN_WIDTH;ZoomToHeight,SCREEN_HEIGHT;"
	/>
	
	<Layer
		File="angrysun" NameCommand="%function(self) gorge_angrysun = self end"
		OnCommand="hidden,0;bob;effectperiod,5;effectclock,timer;effectmagnitude,0,5,0;
		diffuse,1,1,1,.4;zoomto,64,64;playcommand,Name;x,SCREEN_CENTER_X-200;y,SCREEN_CENTER_Y-180 - SCREEN_HEIGHT;"
	/>
	
	<Layer
		File="shaku" NameCommand="%function(self) gorge_shaku = self end"
		OnCommand="hidden,0;bob;effectperiod,5;effectclock,timer;effectmagnitude,0,5,0;
		diffuse,1,1,1,.4;zoomto,96,96;playcommand,Name;x,SCREEN_CENTER_X-200;y,SCREEN_CENTER_Y-180 - SCREEN_HEIGHT;"
	/>
	
	<Layer
		File="cloude" NameCommand="%function(self) gorge_clouds = self end"
		OnCommand="hidden,0;playcommand,Name;x,SCREEN_CENTER_X;y,SCREEN_HEIGHT*0.25;zoomx,2;zoomy,1;customtexturerect,0,0,2,1;texcoordvelocity,.03,0;"
	/>
	<Layer
		File="desert_bottom" NameCommand="%function(self) gorge_desert2 = self end"
		OnCommand="hidden,0;playcommand,Name;x,SCREEN_CENTER_X;y,SCREEN_HEIGHT*0.75;rotationx,-80;
		ZoomToWidth,SCREEN_WIDTH*2;ZoomToHeight,SCREEN_HEIGHT*0.5;zoomz,4*(SCREEN_WIDTH/640);customtexturerect,0,0,5,1;texcoordvelocity,0,-.1;"
	/>
	<Layer
		File="desert_top" NameCommand="%function(self) gorge_desert = self end"
		OnCommand="hidden,0;playcommand,Name;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;ZoomToWidth,SCREEN_WIDTH;ZoomToHeight,SCREEN_HEIGHT;"
	/>
	<Layer
		File="pyramids" NameCommand="%function(self) gorge_pyra = self end"
		OnCommand="hidden,0;playcommand,Name;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;ZoomToWidth,SCREEN_WIDTH;ZoomToHeight,SCREEN_HEIGHT;"
	/>
	
	<Layer
		Type="Quad" NameCommand="%function(self) gorge_quad = self end"
		OnCommand="hidden,0;diffuse,0,0,0,1;playcommand,Name;stretchto,0,SCREEN_HEIGHT,SCREEN_WIDTH,SCREEN_HEIGHT*2;"
	/>
	
	<Layer
		File="castbg" NameCommand="%function(self) gorge_walltop = self end"
		OnCommand="playcommand,Name;diffuse,1,.5,.5,1;cropbottom,.7;fadebottom,.3;zoom,2*(SCREEN_WIDTH/640);vertalign,top;x,SCREEN_CENTER_X;y,SCREEN_HEIGHT;"
	/>
	
	</children> </ActorFrame>
	
	<Layer File="mirrorbg" OnCommand="%function(self) gorge_castbg = self; self:queuecommand('SetMe') end"
	SetMeCommand="diffuse,1,1,1,0;customtexturerect,0,0,1,0.5;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;zoomto,SCREEN_WIDTH*(SCREEN_WIDTH/640)*2,SCREEN_HEIGHT*(SCREEN_WIDTH/640);texcoordvelocity,-0.05*(640/SCREEN_WIDTH),0" />

	<ActorFrame OnCommand="fov,60;"> <children>
	<Layer
		File="background" NameCommand="%function(self) gorge_bg1 = self end"
		OnCommand="hidden,0;playcommand,Name;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;basezoomx,SCREEN_WIDTH/640;basezoomy,SCREEN_HEIGHT/480;diffuse,.5,.5,.5,1;rotationy,180;zoom,0;"
	/>
	</children> </ActorFrame>
	
	
	
	
	<Layer Type="ActorFrame" OnCommand="%function (self) char_imho=self; self:bob();
	self:effectclock('music'); self:effectmagnitude(0,4,0); self:zoom(0); self:zoomx(3); self:diffuse(.5,.5,.5,1) end" HideQCommand="zoomy,0;zoomx,3;"
	HideCommand="bouncebegin,0.2;zoomy,0;zoomx,3;" SpawnCommand="bounceend,0.3;zoom,1;" SpawnQCommand="zoom,1;" > <children>
		
		<ActorFrame OnCommand="%function(self) self:SetDrawByZPosition(true) self:zoom(0.7); self:fov(70) end" ><children>
		
		<Actor
			File="imho/idle.sprite"
			OnCommand="diffusealpha,1"
			IdleCommand="diffusealpha,1"
			AttackCommand="diffusealpha,0"
			HurtCommand="diffusealpha,0"
			CastCommand="diffusealpha,0"
			Cast2Command="diffusealpha,0"
		/>
		
		<Actor
			File="imho/attack.sprite"
			OnCommand="diffusealpha,0"
			IdleCommand="diffusealpha,0"
			AttackCommand="setstate,0;diffusealpha,1;zoom,1.1;linear,0.2;zoom,1;"
			HurtCommand="diffusealpha,0"
			CastCommand="diffusealpha,0"
			Cast2Command="diffusealpha,0"
		/>
		
		<Actor
			File="imho/cast.sprite"
			OnCommand="diffusealpha,0;"
			AttackCommand="diffusealpha,0"
			HurtCommand="diffusealpha,0"
			CastCommand="setstate,0;diffusealpha,1;zoom,1.1;linear,0.2;zoom,1;"
			Cast2Command="setstate,0;diffusealpha,1;zoom,1.1;linear,0.2;zoom,1;"
			IdleCommand="diffusealpha,0"
		/>
		
		<ActorFrame CastCommand="playcommand,Xspin;decelerate,1/1.5;z,150;accelerate,1/1.5;z,0;decelerate,1/1.5;z,-150;accelerate,1/1.5;z,0;"><children>
			<Actor File="imho/lance"
			OnCommand="x,-160;rotationz,-20;bob;effectperiod,4;effectoffset,0;effectmagnitude,0,10,5;effectclock,bgm"
			XspinCommand="accelerate,1/1.5;x,0;rotationz,0;decelerate,1/1.5;x,160;
			rotationz,20;accelerate,1/1.5;x,0;rotationz,0;decelerate,1/1.5;x,-160;rotationz,-20"
			AttackCommand="decelerate,1;rotationz,360-20;sleep,0;rotationz,-20"
			/>
		</children></ActorFrame>
		<ActorFrame CastCommand="playcommand,Xspin;decelerate,1/1.5;z,-150;accelerate,1/1.5;z,0;decelerate,1/1.5;z,150;accelerate,1/1.5;z,0;"><children>
			<Actor File="imho/cane"
			OnCommand="x,160;rotationz,30;bob;effectperiod,4;effectoffset,2;effectmagnitude,0,10,5;effectclock,bgm"
			XspinCommand="accelerate,1/1.5;x,0;rotationz,0;decelerate,1/1.5;x,-160;
			rotationz,-30;accelerate,1;x,0;rotationz,0;decelerate,1/1.5;x,160;rotationz,30"
			AttackCommand="decelerate,1;rotationz,360+30;sleep,0;rotationz,30"
			/>
		</children></ActorFrame>
		
		<Layer Type="ActorFrame" OnCommand="zoom,2.5;spin;effectmagnitude,0,0,90;"><children>
			<Layer File="casting"
			OnCommand="blend,add;diffuse,1,0.5,0,0;"
			CastCommand="%function (self)
				self:zoom(1.1);
				self:linear(0.8);
				self:diffusealpha(1);
				self:linear(1);
				self:zoom(0.7);
				self:linear(0.8);
				self:diffusealpha(0);
			end"
			/>
		</children> </Layer>
		
		<0Layer Type="ActorFrame" CastCommand="%function(self) self:playcommand('Inner'); chara_drand = math.random(0,360);
		chara_dspd = (math.random(0,600)/100)-3; self:playcommand('Turn') end"
		TurnCommand="rotationz,chara_drand;
		linear,0.1;rotationz,chara_drand+(60*chara_dspd);
		linear,0.1;rotationz,chara_drand+(110*chara_dspd);
		linear,0.1;rotationz,chara_drand+(150*chara_dspd);
		linear,0.1;rotationz,chara_drand+(180*chara_dspd);
		linear,0.2;rotationz,chara_drand+(200*chara_dspd);
		linear,1.0;rotationz,chara_drand+(350*chara_dspd);
		linear,0.2;rotationz,chara_drand+(370*chara_dspd);
		linear,0.2;rotationz,chara_drand+(400*chara_dspd);
		linear,0.2;rotationz,chara_drand+(440*chara_dspd);
		linear,0.2;rotationz,chara_drand+(490*chara_dspd);
		linear,0.2;rotationz,chara_drand+(550*chara_dspd);"
		><children>
		<Layer File="triangle"
		OnCommand="vertalign,top;blend,add;diffusealpha,0;fadetop,0.2;fadebottom,0.2;
		diffuseblink;effectcolor1,1,0.5,0,0.3;effectcolor2,1,0.5,0,1;effectperiod,0.066"
		InnerCommand="zoom,1;diffusealpha,0;linear,0.5;diffusealpha,1;zoomy,5;zoomx,3;linear,1.5;
		zoomy,8;zoomx,3;linear,0.6;zoomy,20;zoomx,0;sleep,0;diffusealpha,0;"
		/>
		</children> </0Layer>
		<0Layer Type="ActorFrame" CastCommand="%function(self) self:playcommand('Inner'); chara_drand = math.random(0,360);
		chara_dspd = (math.random(0,600)/100)-3; self:playcommand('Turn') end"
		TurnCommand="rotationz,chara_drand;
		linear,0.1;rotationz,chara_drand+(60*chara_dspd);
		linear,0.1;rotationz,chara_drand+(110*chara_dspd);
		linear,0.1;rotationz,chara_drand+(150*chara_dspd);
		linear,0.1;rotationz,chara_drand+(180*chara_dspd);
		linear,0.2;rotationz,chara_drand+(200*chara_dspd);
		linear,1.0;rotationz,chara_drand+(350*chara_dspd);
		linear,0.2;rotationz,chara_drand+(370*chara_dspd);
		linear,0.2;rotationz,chara_drand+(400*chara_dspd);
		linear,0.2;rotationz,chara_drand+(440*chara_dspd);
		linear,0.2;rotationz,chara_drand+(490*chara_dspd);
		linear,0.2;rotationz,chara_drand+(550*chara_dspd);"
		><children>
		<Layer File="triangle"
		OnCommand="vertalign,top;blend,add;diffusealpha,0;fadetop,0.2;fadebottom,0.2;
		diffuseblink;effectcolor1,1,0.5,0,0.3;effectcolor2,1,0.5,0,1;effectperiod,0.066"
		InnerCommand="zoom,1;diffusealpha,0;linear,0.5;diffusealpha,1;zoomy,5;zoomx,3;linear,1.5;
		zoomy,8;zoomx,3;linear,0.6;zoomy,20;zoomx,0;sleep,0;diffusealpha,0;"
		/>
		</children> </0Layer>
		<0Layer Type="ActorFrame" CastCommand="%function(self) self:playcommand('Inner'); chara_drand = math.random(0,360);
		chara_dspd = (math.random(0,600)/100)-3; self:playcommand('Turn') end"
		TurnCommand="rotationz,chara_drand;
		linear,0.1;rotationz,chara_drand+(60*chara_dspd);
		linear,0.1;rotationz,chara_drand+(110*chara_dspd);
		linear,0.1;rotationz,chara_drand+(150*chara_dspd);
		linear,0.1;rotationz,chara_drand+(180*chara_dspd);
		linear,0.2;rotationz,chara_drand+(200*chara_dspd);
		linear,1.0;rotationz,chara_drand+(350*chara_dspd);
		linear,0.2;rotationz,chara_drand+(370*chara_dspd);
		linear,0.2;rotationz,chara_drand+(400*chara_dspd);
		linear,0.2;rotationz,chara_drand+(440*chara_dspd);
		linear,0.2;rotationz,chara_drand+(490*chara_dspd);
		linear,0.2;rotationz,chara_drand+(550*chara_dspd);"
		><children>
		<Layer File="triangle"
		OnCommand="vertalign,top;blend,add;diffusealpha,0;fadetop,0.2;fadebottom,0.2;
		diffuseblink;effectcolor1,1,0.5,0,0.3;effectcolor2,1,0.5,0,1;effectperiod,0.066"
		InnerCommand="zoom,1;diffusealpha,0;linear,0.5;diffusealpha,1;zoomy,5;zoomx,3;linear,1.5;
		zoomy,8;zoomx,3;linear,0.6;zoomy,20;zoomx,0;sleep,0;diffusealpha,0;"
		/>
		</children> </0Layer>
		<0Layer Type="ActorFrame" CastCommand="%function(self) self:playcommand('Inner'); chara_drand = math.random(0,360);
		chara_dspd = (math.random(0,600)/100)-3; self:playcommand('Turn') end"
		TurnCommand="rotationz,chara_drand;
		linear,0.1;rotationz,chara_drand+(60*chara_dspd);
		linear,0.1;rotationz,chara_drand+(110*chara_dspd);
		linear,0.1;rotationz,chara_drand+(150*chara_dspd);
		linear,0.1;rotationz,chara_drand+(180*chara_dspd);
		linear,0.2;rotationz,chara_drand+(200*chara_dspd);
		linear,1.0;rotationz,chara_drand+(350*chara_dspd);
		linear,0.2;rotationz,chara_drand+(370*chara_dspd);
		linear,0.2;rotationz,chara_drand+(400*chara_dspd);
		linear,0.2;rotationz,chara_drand+(440*chara_dspd);
		linear,0.2;rotationz,chara_drand+(490*chara_dspd);
		linear,0.2;rotationz,chara_drand+(550*chara_dspd);"
		><children>
		<Layer File="triangle"
		OnCommand="vertalign,top;blend,add;diffusealpha,0;fadetop,0.2;fadebottom,0.2;
		diffuseblink;effectcolor1,1,0.5,0,0.3;effectcolor2,1,0.5,0,1;effectperiod,0.066"
		InnerCommand="zoom,1;diffusealpha,0;linear,0.5;diffusealpha,1;zoomy,5;zoomx,3;linear,1.5;
		zoomy,8;zoomx,3;linear,0.6;zoomy,20;zoomx,0;sleep,0;diffusealpha,0;"
		/>
		</children> </0Layer>
		
		</children> </ActorFrame>
		
	</children>	</Layer>
	
	
	

</children> </ActorFrame>